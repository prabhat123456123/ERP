<%- include('../../partials/top-bar') %>

      <!-- Site wrapper -->
      <div class="wrapper">
         <%- include('../../partials/header') %>
		  <style>
      .loading-image {
        position: absolute;
		
        top: 48%;
        left: 32%;
        transform: translateY(-50%) translateX(50%);
      }
      .loader {
        display: none;
        height: 100%;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        position: fixed;
        z-index: 99999;
      }
    </style>
         <!-- =============================================== -->
         <!-- Left side column. contains the sidebar -->
       <%- include('../../partials/sidebar') %>
	
   
         <!-- =============================================== -->
         <!-- Content Wrapper. Contains page content -->
         <div class="content-wrapper">
			   <div class="loader" id="loader">
      <img
        class="loading-image" style="width: 100px;"
        src="/assets/images/loader.webp"
        alt="loading.."
      />
	   </div>
            <!-- Content Header (Page header) -->
            <section class="content-header">
               <div class="header-icon">
                  <i class="fa fa-dashboard"></i>
               </div>
               <div class="header-title">
                  <h1>SMART SCHOOL Dashboard</h1>
                  <small>Very detailed & featured admin.</small>
               </div>
            </section>
			
            <!-- Main content -->
            <section class="content">
          
			<div class="panel panel-bd lobidrag">
                        <div class="panel-heading">
                           <div class="btn-group" id="buttonexport">
                              <a href="#">
                                 <h4>All Faculty</h4>
                              </a>
                           </div>
                        </div>
                        <div class="panel-body">
					 <div class="row"> 
 <div class="col-md-6 text-left">
								 <input type="checkbox" class='checkall' id='checkall'> &nbsp;&nbsp; <input type="button" class="btn-sm btn-danger para" id='delete_record' value='Check All & Delete' >

                <input type="button" id="btnAdd" class="btn-sm btn-primary para" value="Export as PDF" />
                <input type="button" id="btnAdd" class="btn-sm btn-primary para" value="Export as Excel" />
				
            </div>
            <div class="col-md-6 text-right">
 
                                 <a href="#" class="btn btn-add" data-toggle="modal" data-target="#addFaculty-lg"><i class="fa fa-plus"></i> Add New</a>  
                                  
                             
            </div>
			<br>
        </div>
		<br>

					<div class="table-responsive">
						
						<table id="sample_data" class="table table-bordered table-striped">
						
							<thead>
								<tr>
									<th></th>
									<th> Name</th>
									<th> Email</th>
									<th>Gender</th>
									<th>Action</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</div>
		
            </section>
		

            <!-- /.content -->
         </div>
         <!-- /.content-wrapper -->
        <%- include('../../partials/footer') %>
      </div>
	 <div class="modal fade" id="addFaculty-lg" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg"  role="document">
                     <div class="modal-content">
                        <div class="modal-header modal-header-primary">
                           <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                           <h3><i class="fa fa-plus m-r-5"></i> Add New Faculty</h3>
                        </div>
                        <div class="modal-body">
                           <div class="row">
                              <div class="col-md-12">
                                 <form action="http://thememinister.com/crm/index.html" id="loginForm" novalidate>
                  <input type="hidden" class="form-control" name="studentId" id="studentId" value="${studentId}">
                    <input type="hidden" class="form-control" name="schoolId" id="schoolId" value="${schoolId}">
                    <input type="hidden" class="form-control" name="classId" id="classId" value="${classId}">
                            <div class="row">
                                <div class="form-group col-lg-6">
                                    <label>Name</label>
                                    <input type="text" value="" id="name" class="form-control" name="name">
                                </div>
                                  <div class="form-group col-lg-6">
                                    <label>Father's Name</label>
                                    <input type="text" value="" id="father_name" class="form-control" name="father_name">
                                </div>
                                  <div class="form-group col-lg-6">
                                    <label>Mother's Name</label>
                                    <input type="text" value="" id="mother_name" class="form-control" name="mother_name">
                                </div>
                                
                                  <div class="form-group col-lg-6">
                                    <label>Hobbies</label>
                                    <input type="text" value="" id="hobbies" class="form-control" name="hobbies">
                                </div>
                                 <div class="form-group col-lg-6">
                                    <label> Experience</label>
                                    <input type="text" value="" id="hobbies" class="form-control" name="hobbies">
                                </div>
                                 <div class="form-group col-lg-6">
                                    <label>Qualification</label>
                                    <input type="text" value="" id="hobbies" class="form-control" name="hobbies">
                                </div>
                                 <div class="form-group col-lg-6">
                                    <label>Specialize in</label>
                                    <input type="text" value="" id="hobbies" class="form-control" name="hobbies">
                                </div>
                                 <div class="form-group col-lg-6">
                                    <label>Gender</label>
                                   <select name="gender" id="gender" class="form-control">
                                    <option value="">Please Select</option>
                                    <option value="Male">Male</option>
                                    <option value="FeMale">FeMale</option>
                                   </select>
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>DOB</label>
                                    <input type="date" value="" id="dob" class="form-control" name="dob">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>Email ID</label>
                                    <input type="email" value="" id="email" class="form-control" name="email">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>Phone Number</label>
                                    <input type="text" value="" id="phone" class="form-control" name="phone">
                                </div>
                                 <div class="form-group col-lg-6">
                                    <label> Address</label>
                                    <textarea  id="address"  class="form-control" rows="5" name="address"></textarea>
                                  
                                </div>
                               
                                <div class="form-group col-lg-6">
                                    <label>Upload Photo</label>
                                    <input type="file" value="" id="photo" class="form-control" name="photo">
                                </div>
                            </div>
                            <div align="center">
                                <button class="btn btn-warning">Create New</button>
                            </div>
                        </form>
                              </div>
                           </div>
                        </div>
                        <div class="modal-footer">
                           <button type="button" class="btn btn-danger pull-left" data-dismiss="modal">Close</button>
                        </div>
                     </div>
                     <!-- /.modal-content -->
                  </div>
                  <!-- /.modal-dialog -->
               </div>
               
                 <div class="modal fade" id="editFacultyModal" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg"  role="document">
                     <div class="modal-content">
                        <div class="modal-header modal-header-primary">
                           <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                           <h3><i class="fa fa-plus m-r-5"></i> Edit Faculty</h3>
                        </div>
                        <div class="modal-body">
                         
                              <div id="editFacultyDiv">
                               
                             
                           </div>
                        </div>
                        <div class="modal-footer">
                           <button type="button" class="btn btn-danger pull-left" data-dismiss="modal">Close</button>
                        </div>
                     </div>
                     <!-- /.modal-content -->
                  </div>
                  <!-- /.modal-dialog -->
               </div>
                <div class="modal fade" id="deleteFacultyModal" tabindex="-1" role="dialog">
                  <div class="modal-dialog">
                     <div class="modal-content">
                        <div class="modal-header modal-header-primary">
                           <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                           <h3><i class="fa fa-minus m-r-5"></i> Remove Faculty</h3>
                        </div>
                        <div class="modal-body">
                         
                              <div id="deleteFacultyDiv">
                               
                             
                           </div>
                        </div>
                        <div class="modal-footer">
                           <button type="button" class="btn btn-danger pull-left" data-dismiss="modal">Close</button>
                        </div>
                     </div>
                     <!-- /.modal-content -->
                  </div>
                  <!-- /.modal-dialog -->
               </div>
      <!-- /.wrapper -->
      <!-- Start Core Plugins
         =====================================================================-->
   <%- include('../../partials/footer-script') %>

   <script type="text/javascript" language="javascript">
    function editFaculty(studentId,schoolId,classId) {
    try {
      $("#editFacultyDiv").html("");
      $("#editFacultyModal").modal("toggle");
      $.ajax({
         url: `/admission/fetch-student-byid`,
         type: "post",
         data:{studentId:studentId,schoolId:schoolId,classId:classId},
         dataType: "json",
         cache: false,
         success: function (data) {
          alert("teteet")
            let formDetails = ``;
            formDetails += `<form action="http://thememinister.com/crm/index.html" id="loginForm" novalidate>
                  <input type="hidden" class="form-control" name="studentId" id="studentId" value="${studentId}">
                    <input type="hidden" class="form-control" name="schoolId" id="schoolId" value="${schoolId}">
                    <input type="hidden" class="form-control" name="classId" id="classId" value="${classId}">
                            <div class="row">
                                <div class="form-group col-lg-6">
                                    <label>Name</label>
                                    <input type="text" value="" id="name" class="form-control" name="name">
                                </div>
                                  <div class="form-group col-lg-6">
                                    <label>Father's Name</label>
                                    <input type="text" value="" id="father_name" class="form-control" name="father_name">
                                </div>
                                  <div class="form-group col-lg-6">
                                    <label>Mother's Name</label>
                                    <input type="text" value="" id="mother_name" class="form-control" name="mother_name">
                                </div>
                                  <div class="form-group col-lg-6">
                                    <label>Class</label>
                                    <input type="text" value="" id="class" class="form-control" name="class">
                                </div>
                                  <div class="form-group col-lg-6">
                                    <label>Hobbies</label>
                                    <input type="text" value="" id="hobbies" class="form-control" name="hobbies">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>DOB</label>
                                    <input type="date" value="" id="dob" class="form-control" name="dob">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>Email ID</label>
                                    <input type="email" value="" id="email" class="form-control" name="email">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>Phone Number</label>
                                    <input type="text" value="" id="phone" class="form-control" name="phone">
                                </div>
                                 <div class="form-group col-lg-6">
                                    <label>Current Address</label>
                                    <input type="text"  id="studentcurrentaddress1" placeholder="address line 1" class="form-control" name="address1">
                                     <label></label>
                                    <input type="text" id="studentcurrentaddress2" placeholder="address line 2" class="form-control" name="address2">
                                     <label></label>
                                    <input type="text"  id="studentcurrentstate" placeholder="State" class="form-control" name="state">
                                     <label></label>
                                    <input type="text" id="studentcurrentdistrict" placeholder="District" class="form-control" name="district">
                                     <label></label>
                                    <input type="text"  id="studentcurrentcity" placeholder="City" class="form-control" name="city">
                                     <label></label>
                                    <input type="text" id="studentcurrentpincode" placeholder="Pin Code" class="form-control" name="pincode">
                                </div>
                                 <div class="form-group col-lg-6">
                                    
                                    <label>Permanent Address</label> ( <input type="checkbox" name="studentaddresscheck" id="studentaddresscheck"/>Same as Current: )
                                    <input type="text" placeholder="address line 1"  id="studentpermanentaddress1" class="form-control" name="address1">
                                      <label></label>
                                    <input type="text" id="studentpermanentaddress2" placeholder="address line 2" class="form-control" name="address2">
                                     <label></label>
                                    <input type="text"  id="studentpermanentstate" placeholder="State" class="form-control" name="state">
                                     <label></label>
                                    <input type="text" id="studentpermanentdistrict" placeholder="District" class="form-control" name="district">
                                     <label></label>
                                    <input type="text"  id="studentpermanentcity" placeholder="City" class="form-control" name="city">
                                     <label></label>
                                    <input type="text" id="studentpermanentpincode" placeholder="Pin Code" class="form-control" name="pincode">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label>Upload Photo</label>
                                    <input type="file" value="" id="photo" class="form-control" name="photo">
                                </div>
                            </div>
                            <div align="center">
                                <button class="btn btn-warning">Register</button>
                            </div>
                        </form>`;
            $("#editFacultyDiv").html(formDetails);
          
        },
      });
    } catch (err) {
      console.error(err);
    }
  }
   function deleteAdmission(studentId,schoolId,classId) {
    try {
      $("#deleteFacultyDiv").html("");
      $("#deleteFacultyModal").modal("toggle");
   
          
            let formDetails = ``;
            formDetails += ` <form action="/release-student" method="post">
                    <input type="hidden" class="form-control" name="studentId" id="studentId" value="${studentId}">
                    <input type="hidden" class="form-control" name="schoolId" id="schoolId" value="${schoolId}">
                    <input type="hidden" class="form-control" name="classId" id="classId" value="${classId}">
                    
                   <div class="col-md-12">
                    Are You Sure. ?
                   </div>

                   <div class="text-center mt-3">
                    <a  class="btn btn-danger waves-effect waves-light" data-bs-dismiss="modal"> No </a>
                     <button
                       type="submit"
                       class="btn btn-primary waves-effect waves-light"
                       id="register"
                     >
                       Yes
                     </button>
                   </div>
                 </form> `;
            $("#deleteFacultyDiv").html(formDetails);
          
       
    } catch (err) {
      console.error(err);
    }
  }
$(document).ready(function(){
	

	toastr.options = {
				'closeButton': true,
				'debug': false,
				'newestOnTop': false,
				'progressBar': true,
				'positionClass': 'toast-top-center',
				'preventDuplicates': false,
				'showDuration': '1000',
				'hideDuration': '1000',
				'timeOut': '5000',
				'extendedTimeOut': '1000',
				'showEasing': 'swing',
				'hideEasing': 'linear',
				'showMethod': 'fadeIn',
				'hideMethod': 'fadeOut',
			}

    
    // Check all 
   $('#checkall').click(function(){
      if($(this).is(':checked')){
         $('.delete_check').prop('checked', true);
      }else{
         $('.delete_check').prop('checked', false);
      }
   });

   // Delete record
   $('#delete_record').click(function(){
      var deleteids_arr = [];
      // Read all checked checkboxes
      $("input:checkbox[class=delete_check]:checked").each(function () {
         deleteids_arr.push($(this).attr('data-id'));
      });

      // Check checkbox checked or not
      if(deleteids_arr.length > 0){

         // Confirm alert
         var confirmdelete = confirm("Do you really want to Delete records?");
         if (confirmdelete == true) {

			
            $.ajax({
               url: '/admission/delete-multiple',
               type: 'post',
               data: {deleteids_arr: deleteids_arr},
               success: function(response){
				toastr.error('Record Deleted Successfuly !!')
                  $('#sample_data').DataTable().ajax.reload();
               }
            });
         } 
      }
   });
	$(document).on("click",".delBtn",function(){
		 if(confirm('Are you sure you want to delete this?')){
 const id = $(this).attr('data-id');
 $('.loader').css('display','block');
  $.ajax({
        url: '/admission/delete-admission',
        type: "POST",
        data: {
          id:id
        },
        success: function () {
        $('.loader').css('display','none');

     $('#sample_data').DataTable().ajax.reload();
	toastr.error('Record Deleted Successfuly !!')

        }
    });
		 }
 
});
	var dataTable = $('#sample_data').DataTable({
		"processing": true,
		"serverSide": true,
		
		"order":[],
		"ajax":{
			url:"/admission/get-admission",
			type:"POST",
		},
         columns: [
        { data: "check" },
        { data: "name" },
        { data: "email" },
        { data: "gender" },
        { data: "action" },
	],
		createdRow:function(row, data, rowIndex)
		{
			$.each($('td', row), function(colIndex){
				if(colIndex == 1)
				{
					$(this).attr('data-name', 'name');
					$(this).attr('class', 'name');
					$(this).attr('data-type', 'text');
					$(this).attr('data-pk', data.id);
				}
				if(colIndex == 2)
				{
					$(this).attr('data-name', 'email');
					$(this).attr('class', 'email');
					$(this).attr('data-type', 'text');
					$(this).attr('data-pk', data.id);
				}
				if(colIndex == 3)
				{
					$(this).attr('data-name', 'gender');
					$(this).attr('class', 'gender');
					$(this).attr('data-type', 'select');
					$(this).attr('data-pk', data.id);
				}
			});
		}
	});

	$('#sample_data').editable({
		container:'body',
		selector:'td.name',
		url:'/admission/update-admission',
		title:'Name',
		type:'POST',
		validate:function(value){
			if($.trim(value) == '')
			{
				return 'This field is required';
			}
				toastr.success('Record Updated Successfuly !!')

		}
		
	});

	$('#sample_data').editable({
		container:'body',
		selector:'td.email',
		url:'/admission/update-admission',
		title:'Email',
		type:'POST',
		validate:function(value){
			
			if($.trim(value) == '')
			{
				return 'This field is required';
			}
			toastr.success('Record Updated Successfuly !!')
		}
	});

	$('#sample_data').editable({
		container:'body',
		selector:'td.gender',
		url:'/admission/update-admission',
		title:'Gender',
		type:'POST',
		datatype:'json',
		source:[{value: "Male", text: "Male"}, {value: "Female", text: "Female"}],
		validate:function(value){
			
			if($.trim(value) == '')
			{
				return 'This field is required';
			}
			toastr.success('Record Updated Successfuly !!')
		}
	});
	
});	
</script>